/*!
 * Codecolor.js v1.0.0
 * https://codecolorjs.pw/
 *
 * (c) 2018-2018 Daniil Ryazanov <opensource@tagproject.ru>
 * Released under the MIT License.
 */

(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.codecolor=b()})(this,function(){"use strict";const a="fragment",b=["comment","template","string","number",a,"operator"],c=["keyword","primitive","builtin"];class d{constructor(a){const d=function(a,b){return a.reduce((a,c)=>("undefined"!=typeof b[c]&&a.push(b[c]),a),[])};this.literals=d(b,a.literals),this.statements=d(c,a.statements),this.masks="object"==typeof a.masks?a.masks:{}}eachLiterals(a){this.literals.forEach((c,d)=>{c.forEach((c,e)=>{a(b[d],c,e)})})}getStatementName(a){const b=a[0];let d,e=0;for(;(d=this.statements[e])&&!(d[b]&&~d[b].indexOf(a));)e++;return c[e]}getMask(a,b){return this.masks[a][b]}isMasked(a,c){return!!~b.indexOf(a)&&Array.isArray(this.masks[a])&&Array.isArray(this.masks[a][c])}}class e{constructor(a,b,c,d){this.name=a,this.value=b,this.start=c,this.end=c+b.length,this.ruleIndex=d}isIncludeIn(a){return this.start>=a.start&&this.end<=a.end}isFragment(){return this.name===a}}class f{static parse(a,b,c){const d=new f(a,b,c);return d.analize(),d.render()}constructor(a,b,c){this.code=a,this.languages=c,this.language=c[b],this.tokens=[]}analize(){let a,b,c,d,f=NaN;const{tokens:g}=this,h=a=>~~(a/2),i=(a,b)=>{if(b<=g.length&&a<b){if(d=g[b-1],d.end<=c.start)return i(b,b+h(g.length-b+1));if(d.start>=c.end)return i(a,a+h(b-a));if(c.isIncludeIn(d))return NaN;if(d.isIncludeIn(c))return-(b-1)}return b};this.language.eachLiterals((d,j,k)=>{var l=Math.abs,m=Math.max;for(b=new RegExp(j,"gm");a=b.exec(this.code);)c=new e(d,a[0],a.index,k),0<=(f=i(0,m(h(g.length),1)))?g.splice(f,0,c):g[l(f)]=c})}wrap(a){const b=(a,b)=>`<span class="cc-${a}">${b}</span>`,c=a.isFragment()?this.language.getStatementName(a.value):a.name;let d;if("undefined"==typeof c)d=a.value;else if(this.language.isMasked(c,a.ruleIndex)){const e=this.language.getMask(c,a.ruleIndex),g=new RegExp(e[0],"gm"),h=[];let i,j=0;for(;i=g.exec(a.value);)h.push(a.value.substring(j,i.index),b(`${c}-mask-${a.ruleIndex}`,f.parse(i[0],e[1],this.languages))),j=g.lastIndex;h.push(a.value.substring(j,a.value.length)),d=b(c,h.join(""))}else d=b(c,a.value);return d}render(){let a=0;const b=[];return this.tokens.forEach(c=>{a<c.start&&b.push(this.code.substring(a,c.start)),b.push(this.wrap(c)),a=c.end}),b.push(this.code.substring(a)),b.join("")}}var g=new class{constructor(){Object.defineProperty(this,"version",{enumerable:!0,writable:!0,value:"1.0.0"}),Object.defineProperty(this,"languages",{enumerable:!0,writable:!0,value:{}})}highlight(a,b){return["<pre><code class=\"cc-container\">",f.parse(a,b||this.activeSchema,this.languages),"</code></pre>"].join("")}addSchema(a){return this.languages[a.name]=new d(a),this.activeSchema=a.name,a.name}};return g});
